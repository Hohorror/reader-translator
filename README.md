# PDF Reader & Translator Backend API

Бэкенд API для интерактивного веб-приложения, предназначенного для чтения и изучения книг в формате PDF с возможностями перевода, озвучивания и ведения личного словаря.

## Обзор проекта

Этот проект предоставляет API, которое позволяет:
- Управлять пользователями (регистрация, аутентификация).
- Загружать, хранить и управлять PDF-файлами для каждого пользователя.
- Предоставлять эндпоинты для перевода текста (слов, страниц).
- Управлять персональным словарем пользователя (добавление, удаление, просмотр слов).
- Обрабатывать запросы на сопоставление текстов для подготовленных книг.

API построено с использованием FastAPI и предназначено для использования с отдельным фронтенд-приложением.

## Основные функции API

- **Аутентификация:** Регистрация и вход пользователей с использованием JWT.
- **Управление файлами:** Загрузка, получение списка и удаление PDF-файлов пользователя.
- **Перевод:** Эндпоинты для перевода текста с использованием внешних сервисов и резервного словаря.
- **Словарь:** CRUD-операции для управления личным словарем пользователя.
- **Сопоставление текстов:** API для работы с предварительно подготовленными текстами.

## Технологии

- **Backend:**
  - **FastAPI:** Современный высокопроизводительный Python веб-фреймворк.
  - **SQLite/SQLAlchemy:** База данных (используется SQLite в Docker-контейнере) и ORM.
  - **JWT (python-jose, passlib):** Аутентификация и авторизация.
  - **Pydantic:** Валидация данных.
  - **Deep-translator:** Библиотека для перевода текста.
  - **Uvicorn:** ASGI-сервер.
- **Инфраструктура:**
  - **Docker & Docker Compose:** Контейнеризация и оркестрация для разработки и деплоя.

## Структура проекта (Бэкенд)

```
app/                 # Основное приложение FastAPI
├── api/             # (Предполагаемая директория для API-маршрутов, если используется)
├── core/            # Базовая конфигурация и утилиты
├── db/              # Настройки базы данных
├── models/          # Модели данных SQLAlchemy/Pydantic
├── repositories/    # Репозитории для доступа к данным
├── routers/         # Маршруты FastAPI (если используются)
├── schemas/         # Схемы Pydantic для валидации
├── services/        # Бизнес-логика
├── __init__.py
├── auth.py          # Логика аутентификации
├── database.py      # Настройки подключения к БД
├── main.py          # Основной файл приложения FastAPI
└── models.py        # Дополнительные модели (может быть объединено с app/models/)

alembic/             # Миграции базы данных (если используются)
uploads/             # Директория для загруженных файлов (внутри контейнера)
tests/               # Директория для тестов (если есть)

.gitignore
alembic.ini          # Конфигурация Alembic (если используется)
docker-compose.yml   # Конфигурация Docker Compose
Dockerfile           # Dockerfile для сборки образа приложения
README.md            # Этот файл
requirements.txt     # Зависимости Python
```
*Примечание: Директории `static` и `templates` были удалены, так как фронтенд разрабатывается отдельно.*

## API-эндпоинты

Подробный список доступных API-эндпоинтов, их параметры и ожидаемые ответы можно найти в интерактивной документации **Swagger UI**.

### Основные группы эндпоинтов:
- **Аутентификация (`/api/token`, `/api/register`, `/api/users/me`)**
- **Файлы (`/api/files`, `/api/files/upload`, `/api/files/{file_id}`)**
- **Перевод (`/api/translate`, `/api/book-mapping/...`)**
- **Словарь (`/api/dictionary`, `/api/dictionary/{word_id}`, `/api/dictionary/check`)**

## Запуск с помощью Docker

Это рекомендуемый способ запуска бэкенда для разработки и тестирования.

1.  **Убедитесь, что Docker и Docker Compose установлены.**
2.  **Клонируйте репозиторий:**
    ```bash
    git clone <url-вашего-репозитория>
    cd <имя-директории-проекта>
    ```
3.  **Запустите контейнеры:**
    ```bash
    docker compose up --build -d
    ```
    Эта команда соберет Docker-образ для FastAPI приложения (если он еще не собран или изменился) и запустит контейнеры для приложения и базы данных PostgreSQL в фоновом режиме.

4.  **Доступ к API:**
    - Бэкенд API будет доступен по адресу: `http://localhost:8000`
    - Интерактивная документация Swagger UI: `http://localhost:8000/docs`

## Тестирование API через Swagger UI

1.  **Откройте Swagger UI:** Перейдите по адресу `http://localhost:8000/docs` в вашем браузере.
2.  **Изучите эндпоинты:** Ознакомьтесь с доступными маршрутами API.
3.  **Авторизация (для защищенных эндпоинтов):**
    *   Сначала используйте эндпоинт `POST /api/register` для создания пользователя (если еще не создали).
    *   Затем используйте `POST /api/token`, введя имя пользователя и пароль в тело запроса (`application/x-www-form-urlencoded`), чтобы получить `access_token`.
    *   Нажмите кнопку "Authorize" в правом верхнем углу Swagger UI.
    *   В появившемся окне в поле "Value" введите `Bearer <ваш_access_token>` (замените `<ваш_access_token>` на полученный токен) и нажмите "Authorize".
4.  **Выполнение запросов:** Теперь вы можете использовать кнопку "Try it out" и "Execute" для любого эндпоинта, включая защищенные. Swagger автоматически будет добавлять ваш токен в заголовки запросов.

## Остановка контейнеров

Чтобы остановить запущенные контейнеры:
```bash
docker compose down
```

## Лицензия

Проект распространяется под лицензией MIT. 